## 什么是内存模型



java内存模型(Java Memory Model，JMM)是用来统一java程序在各种不同硬件和操作系统中内存的访问差异，也就是可以达到内存访问一致性。它的结果如下：

<img src="/Users/nate/Library/Application Support/typora-user-images/image-20191108154623201.png" alt="image-20191108154623201" style="zoom:50%;" />

如何解决缓存一致性，使用内存屏障

为什么需要内存屏障

- 在多处理器的系统中，每个处理器都会有自己的cache缓存，这些缓存并不是实时同步的，所以会存在每个处理器中缓存不一致的问题。
- 操作系统有可能会对指令进行重排序

内存屏障的作用

- 阻止屏障两侧指令冲排序
- 强制把写缓冲区/高速缓存中的脏数据等写回主内存，让缓存中相应的数据失效。